
<div *ngIf="!error().error" class="card">
  <div class="row justify-content-between">
    <h5 class="card-header">
      MFO</h5>
    <div class="">
      <div class="row px-4">
        <div class="col-6">
          <div class="input-group">
            <span class="input-group-text">
              <div class="spinner-border spinner-border-sm text-primary" role="status"
                *ngIf="isSearchLoading(); else showIcon">
                <span class="visually-hidden">Loading...</span>
              </div>
              <ng-template #showIcon>
                <i class="tf-icons bx bx-search"></i>
              </ng-template>
            </span>
            <input type="text" [(ngModel)]="search.MFO" (ngModelChange)="searchMfoOffice()" class="form-control"
              placeholder="Search..." /> 
          </div>
        </div>
        <div class="col-6">
          <button type="button" class="btn btn-primary float-end" data-bs-toggle="offcanvas"
            data-bs-target="#offcanvasScroll" aria-controls="offcanvasScroll">
            <i class='bx bx-plus'></i>MFO
          </button>
        </div>
      </div>
      <div class="table-responsive text-nowrap w-100">
        <table class="table table-hover mt-5 ">
          <thead>
            <tr>
              <td></td>
              <th>#</th>
              <th>MFO</th>
              <th>Actions</th>
            </tr>
          </thead>

          <ng-container *ngIf="mfo().isLoading">
            <tbody>
              <tr>
                <td colspan="4" class="text-center"><app-spinner></app-spinner>
                </td>
              </tr>
            </tbody>
          </ng-container>
          <tbody *ngFor="let a of mfo().data; let i = index" class="table-border-bottom-0">
            <tr>
              <td style="max-width: 5px;" (click)="expandedRow == i?expandedRow = null :expandedRow = i"><i
                  class='bx bx-chevron-right'></i>
              </td>
              <td style="max-width: 5px;">{{i+1}}</td>
              <td style="max-width: 800px;min-width: 800px;">{{a.mfo}}</td>
              <td>
                <div class="dropdown">
                  <button type="button" class="btn p-0 dropdown-toggle hide-arrow" data-bs-toggle="dropdown">
                    <i class="bx bx-dots-vertical-rounded"></i>
                  </button>
                  <div class="dropdown-menu">
                    <a class="dropdown-item" href="javascript:void(0);"><i class="bx bx-edit-alt me-1"></i> Edit</a>
                    <a class="dropdown-item" href="javascript:void(0);"><i class="bx bx-trash me-1"></i> Delete</a>
                  </div>
                </div>
              </td>
            </tr>
            <ng-container *ngIf="expandedRow == i">
              <tr *ngFor="let b of a.si; let y = index" class="bg-lightest">
                <td colspan="4" class="p-custom bg-lightest"
                  (click)="expandedRowChild == y ? expandedRowChild = null :expandedRowChild = y">
                  <div>
                    <div class="form-text text-gray">
                      <i class='bx bx-chevron-right'></i> {{b.indicator}}
                    </div>
                    <ng-container *ngIf="expandedRowChild == y">
                      <!-- Bordered Table -->
                      <div class="card">
                        <div class="card-body">
                          <div class="table-responsive text-nowrap">
                            <table class="table table-bordered ">
                              <thead>
                                <th>
                                  Rating
                                </th>
                                <th>
                                  Quality
                                </th>
                                <th>
                                  Timeliness
                                </th>
                              </thead>
                              <tbody>
                                <tr>
                                  <td>5</td>
                                  <td>{{b.standard.qlty5}}</td>
                                  <td>{{b.standard.timely5}}</td>
                                </tr>
                                <tr>
                                  <td>4</td>
                                  <td>{{b.standard.qlty4}}</td>
                                  <td>{{b.standard.timely4}}</td>
                                </tr>
                                <tr>
                                  <td>3</td>
                                  <td>{{b.standard.qlty3}}</td>
                                  <td>{{b.standard.timely3}}</td>
                                </tr>
                                <tr>
                                  <td>2</td>
                                  <td>{{b.standard.qlty2}}</td>
                                  <td>{{b.standard.timely2}}</td>
                                </tr>
                                <tr>
                                  <td>1</td>
                                  <td>{{b.standard.qlty1}}</td>
                                  <td>{{b.standard.timely1}}</td>
                                </tr>
                              </tbody>
                            </table>
                          </div>
                        </div>
                      </div>

                   
                    </ng-container>
                  </div>
                </td>
              </tr>
            </ng-container>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
<div class="col-lg-4 col-md-6">
  <div class="mt-3">
    <div class="offcanvas offcanvas-end" data-bs-scroll="true" data-bs-backdrop="false" tabindex="-1"
      id="offcanvasScroll" aria-labelledby="offcanvasScrollLabel">
      <div class="offcanvas-header">
        <h5 id="offcanvasScrollLabel" class="offcanvas-title">CREATE MFO</h5>
        <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
      </div>
      <div class="offcanvas-body my-auto mx-0 flex-grow-0">
        <label for="nameWithTitle" class="form-label">MFO</label>
        <input [(ngModel)]="data.MFO" type="text" (ngModelChange)="CheckMfoIfExist()" id="nameWithTitle" class="form-control" placeholder="Enter MFO" />
        <br>
        <button type="button" class="btn btn-primary mb-2 d-grid w-100" (click)="AddMfo()">
          <div
          class="spinner-border spinner-border-sm text-primary"
          role="status"
          *ngIf="mfo().isLoadingSave; else showSubmitLabel"
        >
          <span class="visually-hidden">Loading...</span>
        </div>
        <ng-template #showSubmitLabel>
          Submit
        </ng-template>
        </button>
        <button type="button" class="btn btn-outline-secondary d-grid w-100" data-bs-dismiss="offcanvas">
          Cancel
        </button>
      </div>
    </div>
  </div>
</div>